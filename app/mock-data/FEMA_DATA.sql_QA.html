<html>
<head>
<title>PIH DCG Tools </title>
</head>
<body>
<hr>
<p align='center'>
<font color='#008000'><font face='Ariel' size=3><b>
WARNING<br>
THIS CODE IS SUPPLIED AS IS AND NO WARRENTY IS IMPLIED 
</b></font><font>
</p>
<p>
<font color='#008000'><font face='Ariel' size=3><span style='font-variant: small-caps'>
Due to the variety of ways SQL code can be written parsing may not be accurate.
All errors reported should be checked manually and additional errors may exists<br>
<br>
This tool is <b>NOT</b> a replacement for team QA reviews and does not
guarantee code compliance with PIH Coding Standards.<br>
<br>
$Header:   //hlannrp022/pvcs/PDBs/REACDb/archives/HUDSYSTEMS/a-dcg/dcg_qa_plsql.vbs-arc   1.17   Jan 14 2011 09:45:26   H56315  $<br>
<hr>
</span></font></font></p>
<p nowrap><font color='#000000'><font face='Courier New' size = 2>
<ul>
<font color='#FF0000'><li>The file name FEMA_DATA.sql is not the same as the procedure/package name PACKAGE FEMA_DATA; CREATE OR REPLACE PACKAGE FEMA_DATA - 1</font><br>
<font color='#FF0000'><li>The file name FEMA_DATA.sql is not the same as the procedure/package name FEMA_DATA;- 2</font><br>
<font color='#FF0000'><li>$Header$ not found within procedure code or package body </font><br>
</ul>
<nobr> <font color='#0000FF'> CREATE </font><br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> OR </font> <font color='#0000FF'> REPLACE </font> <font color='#0000FF'> PACKAGE </font> fema_data <font color='#0000FF'> AS </font><br>
<nobr> <font color='#0000FF'> TYPE </font> recordArray <font color='#0000FF'> IS </font><br>
<nobr> <font color='#0000FF'> TABLE </font> <font color='#0000FF'> OF </font> FEMA_HOUSEHOLD_DATA_HOUSEHOLD%ROWTYPE <font color='#0000FF'> INDEX </font> <font color='#0000FF'> BY </font> PLS_INTEGER ;<br>
<nobr> <font color='#0000FF'> TYPE </font> charParameterArray <font color='#0000FF'> IS </font><br>
<nobr> <font color='#0000FF'> TABLE </font> <font color='#0000FF'> OF </font> <font color='#0000FF'> VARCHAR2 </font> ( <font color='#FF00FF'> 32767 </font> ) <font color='#0000FF'> INDEX </font> <font color='#0000FF'> BY </font> PLS_INTEGER ;<br>
<nobr> <font color='#0000FF'> TYPE </font> nbrParameterArray <font color='#0000FF'> IS </font><br>
<nobr> <font color='#0000FF'> TABLE </font> <font color='#0000FF'> OF </font> <font color='#0000FF'> NUMBER </font> ( <font color='#FF00FF'> 5 </font> ) <font color='#0000FF'> INDEX </font> <font color='#0000FF'> BY </font> PLS_INTEGER ;<br>
<nobr> <font color='#0000FF'> TYPE </font> localeArray <font color='#0000FF'> IS </font><br>
<nobr> <font color='#0000FF'> TABLE </font> <font color='#0000FF'> OF </font> <font color='#0000FF'> VARCHAR2 </font> ( <font color='#FF00FF'> 32767 </font> ) <font color='#0000FF'> INDEX </font> <font color='#0000FF'> BY </font> PLS_INTEGER ;<br>
<nobr> <font color='#0000FF'> TYPE </font> disasterArray <font color='#0000FF'> IS </font><br>
<nobr> <font color='#0000FF'> TABLE </font> <font color='#0000FF'> OF </font> <font color='#0000FF'> NUMBER </font> ( <font color='#FF00FF'> 5 </font> ) <font color='#0000FF'> INDEX </font> <font color='#0000FF'> BY </font> PLS_INTEGER ;<br>
<nobr> emptyCharParm charParameterArray ;<br>
<nobr> emptyNbrParm nbrParameterArray ;<br>
<nobr> <font color='#0000FF'> TYPE </font> summaryRec <font color='#0000FF'> IS </font><br>
<nobr> <font color='#0000FF'> RECORD </font> ( HSHD_SIZE_CNT <font color='#0000FF'> NUMBER </font> ( <font color='#FF00FF'> 10 </font> ) , DPNDNT_CNT <font color='#0000FF'> NUMBER </font> ( <font color='#FF00FF'> 13 </font> , <font color='#FF00FF'> 2 </font> ) , INCM_AMNT <font color='#0000FF'> NUMBER </font> ( <font color='#FF00FF'> 13 </font> , <font color='#FF00FF'> 2 </font> ) , HZRD_INSNC_AMNT <font color='#0000FF'> NUMBER </font> ( <font color='#FF00FF'> 13 </font> , <font color='#FF00FF'> 2 </font> ) , FLOOD_INSNC_AMNT <font color='#0000FF'> NUMBER </font> ( <font color='#FF00FF'> 13 </font> , <font color='#FF00FF'> 2 </font> ) , OTHER_INSNC_AMNT <font color='#0000FF'> NUMBER </font> ( <font color='#FF00FF'> 13 </font> , <font color='#FF00FF'> 2 </font> ) , REAL_PROP_LOSS_AMNT <font color='#0000FF'> NUMBER </font> ( <font color='#FF00FF'> 13 </font> , <font color='#FF00FF'> 2 </font> ) , FLOOD_DMGE_AMNT <font color='#0000FF'> NUMBER </font> ( <font color='#FF00FF'> 13 </font> , <font color='#FF00FF'> 2 </font> ) , FNDTN_DMGE_AMNT <font color='#0000FF'> NUMBER </font> ( <font color='#FF00FF'> 13 </font> , <font color='#FF00FF'> 2 </font> ) , ROOF_DMGE_AMNT <font color='#0000FF'> NUMBER </font> ( <font color='#FF00FF'> 13 </font> , <font color='#FF00FF'> 2 </font> ) , TMP_SHLTR_RCVD_AMNT <font color='#0000FF'> NUMBER </font> ( <font color='#FF00FF'> 13 </font> , <font color='#FF00FF'> 2 </font> ) , RENT_ASSTN_AMNT <font color='#0000FF'> NUMBER </font> ( <font color='#FF00FF'> 18 </font> , <font color='#FF00FF'> 2 </font> ) , REPR_AMNT <font color='#0000FF'> NUMBER </font> ( <font color='#FF00FF'> 18 </font> , <font color='#FF00FF'> 2 </font> ) , RPMT_AMNT <font color='#0000FF'> NUMBER </font> ( <font color='#FF00FF'> 13 </font> , <font color='#FF00FF'> 2 </font> ) , SBA_RCVD_AMNT <font color='#0000FF'> NUMBER </font> ( <font color='#FF00FF'> 13 </font> , <font color='#FF00FF'> 2 </font> ) , PRSNL_PROP_ASSTN_AMNT <font color='#0000FF'> NUMBER </font> ( <font color='#FF00FF'> 13 </font> , <font color='#FF00FF'> 2 </font> ) , OTHER_ASSTN_AMNT <font color='#0000FF'> NUMBER </font> ( <font color='#FF00FF'> 13 </font> , <font color='#FF00FF'> 2 </font> ) , TOTAL_DMGE_AMNT <font color='#0000FF'> NUMBER </font> ( <font color='#FF00FF'> 13 </font> , <font color='#FF00FF'> 2 </font> ) , TOTAL_ASSTN_AMNT <font color='#0000FF'> NUMBER </font> ( <font color='#FF00FF'> 13 </font> , <font color='#FF00FF'> 2 </font> ) , HUD_UNMT_NEED_AMNT <font color='#0000FF'> NUMBER </font> ( <font color='#FF00FF'> 13 </font> , <font color='#FF00FF'> 2 </font> ) ) ;<br>
<nobr> <font color='#0000FF'> TYPE </font> summaryArray <font color='#0000FF'> IS </font><br>
<nobr> <font color='#0000FF'> TABLE </font> <font color='#0000FF'> OF </font> summaryRec <font color='#0000FF'> INDEX </font> <font color='#0000FF'> BY </font> PLS_INTEGER ;<br>
<nobr> <font color='#0000FF'> PROCEDURE </font> get_locales ( stateid <font color='#0000FF'> IN </font> <font color='#0000FF'> VARCHAR2 </font> , localetype <font color='#0000FF'> IN </font> <font color='#0000FF'> VARCHAR2 </font> , disasterid <font color='#0000FF'> IN </font> nbrParameterArray , results <font color='#0000FF'> OUT </font> localeArray ) ;<br>
<nobr> <font color='#0000FF'> PROCEDURE </font> get_disasters ( stateid <font color='#0000FF'> IN </font> <font color='#0000FF'> VARCHAR2 </font> , localetype <font color='#0000FF'> IN </font> <font color='#0000FF'> VARCHAR2 </font> <font color='#0000FF'> DEFAULT </font> <font color='#0000FF'> NULL </font> , localevalues <font color='#0000FF'> IN </font> charParameterArray <font color='#0000FF'> DEFAULT </font> emptyCharParm , results <font color='#0000FF'> OUT </font> disasterArray ) ;<br>
<nobr> <font color='#0000FF'> PROCEDURE </font> get_records ( disasterid <font color='#0000FF'> IN </font> nbrParameterArray <font color='#0000FF'> DEFAULT </font> emptyNbrParm , stateid <font color='#0000FF'> IN </font> <font color='#0000FF'> VARCHAR2 </font> <font color='#0000FF'> DEFAULT </font> <font color='#0000FF'> NULL </font> , localetype <font color='#0000FF'> IN </font> <font color='#0000FF'> VARCHAR2 </font> <font color='#0000FF'> DEFAULT </font> <font color='#0000FF'> NULL </font> , localevalues <font color='#0000FF'> IN </font> charParameterArray <font color='#0000FF'> DEFAULT </font> emptyCharParm , results <font color='#0000FF'> OUT </font> recordArray ) ;<br>
<nobr> <font color='#0000FF'> PROCEDURE </font> get_summary_records ( disasterid <font color='#0000FF'> IN </font> nbrParameterArray <font color='#0000FF'> DEFAULT </font> emptyNbrParm , stateid <font color='#0000FF'> IN </font> <font color='#0000FF'> VARCHAR2 </font> <font color='#0000FF'> DEFAULT </font> <font color='#0000FF'> NULL </font> , localetype <font color='#0000FF'> IN </font> <font color='#0000FF'> VARCHAR2 </font> <font color='#0000FF'> DEFAULT </font> <font color='#0000FF'> NULL </font> , localevalues <font color='#0000FF'> IN </font> charParameterArray <font color='#0000FF'> DEFAULT </font> emptyCharParm , results <font color='#0000FF'> OUT </font> summaryArray ) ;<br>
<nobr> <font color='#0000FF'> END </font> fema_data ;<br>
<nobr> /<br>
<nobr> <font color='#0000FF'> CREATE </font><br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> OR </font> <font color='#0000FF'> REPLACE </font> <font color='#0000FF'> PACKAGE </font> <font color='#0000FF'> BODY </font> fema_data <font color='#0000FF'> AS </font><br>
<nobr> <font color='#0000FF'> PROCEDURE </font> get_locales ( stateid <font color='#0000FF'> IN </font> <font color='#0000FF'> VARCHAR2 </font> , localetype <font color='#0000FF'> IN </font> <font color='#0000FF'> VARCHAR2 </font> , disasterid <font color='#0000FF'> IN </font> nbrParameterArray , results <font color='#0000FF'> OUT </font> localeArray ) <font color='#0000FF'> AS </font><br>
<nobr> <font color='#0000FF'> BEGIN </font><br>
<nobr> <font color='#0000FF'> IF </font> localetype = <font color='#FF00FF'> 'city' </font><br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> AND </font> disasterid.COUNT = <font color='#FF00FF'> 0 </font> <font color='#0000FF'> THEN </font><br>
<nobr>&nbsp&nbsp&nbsp&nbsp <font color='#0000FF'> SELECT </font> <font color='#0000FF'> UNIQUE </font> DMGE_CITY_NAME <font color='#0000FF'> AS </font><br>
<nobr> city BULK COLLECT <font color='#0000FF'> INTO </font> results<br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> FROM </font> FEMA_HOUSEHOLD_DATA_HOUSEHOLD fad<br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> WHERE </font> fad.DMGE_STATE_CD = stateid<br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> ORDER </font> <font color='#0000FF'> BY </font> <font color='#FF00FF'> 1 </font> ;<br>
<nobr> <font color='#0000FF'> ELSIF </font> localetype = <font color='#FF00FF'> 'city' </font><br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> AND </font> disasterid.COUNT > <font color='#FF00FF'> 0 </font> <font color='#0000FF'> THEN </font><br>
<nobr> <font color='#0000FF'> SELECT </font> <font color='#0000FF'> UNIQUE </font> DMGE_CITY_NAME <font color='#0000FF'> AS </font><br>
<nobr> city BULK COLLECT <font color='#0000FF'> INTO </font> results<br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> FROM </font> FEMA_HOUSEHOLD_DATA_HOUSEHOLD fad<br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> WHERE </font> fad.DMGE_STATE_CD = stateid<br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> AND </font> fad.DSTER_ID <font color='#0000FF'> IN </font> (<br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> SELECT </font> *<br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> FROM </font> <font color='#0000FF'> TABLE </font> ( disasterid ) )<br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> ORDER </font> <font color='#0000FF'> BY </font> <font color='#FF00FF'> 1 </font> ;<br>
<nobr> <font color='#0000FF'> ELSIF </font> localetype = <font color='#FF00FF'> 'county' </font><br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> AND </font> disasterid.COUNT = <font color='#FF00FF'> 0 </font> <font color='#0000FF'> THEN </font><br>
<nobr> <font color='#0000FF'> SELECT </font> <font color='#0000FF'> UNIQUE </font> CNTY_NAME <font color='#0000FF'> AS </font><br>
<nobr> county BULK COLLECT <font color='#0000FF'> INTO </font> results<br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> FROM </font> FEMA_HOUSEHOLD_DATA_HOUSEHOLD fad<br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> WHERE </font> fad.DMGE_STATE_CD = stateid<br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> ORDER </font> <font color='#0000FF'> BY </font> <font color='#FF00FF'> 1 </font> ;<br>
<nobr> <font color='#0000FF'> ELSIF </font> localetype = <font color='#FF00FF'> 'county' </font><br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> AND </font> disasterid.COUNT > <font color='#FF00FF'> 0 </font> <font color='#0000FF'> THEN </font><br>
<nobr> <font color='#0000FF'> SELECT </font> <font color='#0000FF'> UNIQUE </font> CNTY_NAME <font color='#0000FF'> AS </font><br>
<nobr> county BULK COLLECT <font color='#0000FF'> INTO </font> results<br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> FROM </font> FEMA_HOUSEHOLD_DATA_HOUSEHOLD fad<br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> WHERE </font> fad.DMGE_STATE_CD = stateid<br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> AND </font> fad.DSTER_ID <font color='#0000FF'> IN </font> (<br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> SELECT </font> *<br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> FROM </font> <font color='#0000FF'> TABLE </font> ( disasterid ) )<br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> ORDER </font> <font color='#0000FF'> BY </font> <font color='#FF00FF'> 1 </font> ;<br>
<nobr> <font color='#0000FF'> ELSIF </font> localetype = <font color='#FF00FF'> 'congrdist' </font><br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> AND </font> disasterid.COUNT = <font color='#FF00FF'> 0 </font> <font color='#0000FF'> THEN </font><br>
<nobr> <font color='#0000FF'> SELECT </font> <font color='#0000FF'> UNIQUE </font> FCD_FIPS91_CD <font color='#0000FF'> AS </font><br>
<nobr> congrdist BULK COLLECT <font color='#0000FF'> INTO </font> results<br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> FROM </font> FEMA_HOUSEHOLD_DATA_HOUSEHOLD fad<br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> WHERE </font> fad.DMGE_STATE_CD = stateid<br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> ORDER </font> <font color='#0000FF'> BY </font> <font color='#FF00FF'> 1 </font> ;<br>
<nobr> <font color='#0000FF'> ELSIF </font> localetype = <font color='#FF00FF'> 'congrdist' </font><br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> AND </font> disasterid.COUNT > <font color='#FF00FF'> 0 </font> <font color='#0000FF'> THEN </font><br>
<nobr> <font color='#0000FF'> SELECT </font> <font color='#0000FF'> UNIQUE </font> FCD_FIPS91_CD <font color='#0000FF'> AS </font><br>
<nobr> congrdist BULK COLLECT <font color='#0000FF'> INTO </font> results<br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> FROM </font> FEMA_HOUSEHOLD_DATA_HOUSEHOLD fad<br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> WHERE </font> fad.DMGE_STATE_CD = stateid<br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> AND </font> fad.DSTER_ID <font color='#0000FF'> IN </font> (<br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> SELECT </font> *<br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> FROM </font> <font color='#0000FF'> TABLE </font> ( disasterid ) )<br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> ORDER </font> <font color='#0000FF'> BY </font> <font color='#FF00FF'> 1 </font> ;<br>
<nobr> <font color='#0000FF'> END </font> <font color='#0000FF'> IF </font> ;<br>
<nobr> <font color='#0000FF'> EXCEPTION </font><br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> WHEN </font> no_data_found <font color='#0000FF'> THEN </font><br>
<nobr> DBMS_OUTPUT.PUT_LINE ( <font color='#FF00FF'> 'No data returned' </font> ) ;<br>
<nobr> <font color='#0000FF'> RAISE </font> ;<br>
<nobr> <font color='#0000FF'> END </font> get_locales ;<br>
<nobr> <font color='#0000FF'> PROCEDURE </font> get_disasters ( stateid <font color='#0000FF'> IN </font> <font color='#0000FF'> VARCHAR2 </font> , localetype <font color='#0000FF'> IN </font> <font color='#0000FF'> VARCHAR2 </font> <font color='#0000FF'> DEFAULT </font> <font color='#0000FF'> NULL </font> , localevalues <font color='#0000FF'> IN </font> charParameterArray <font color='#0000FF'> DEFAULT </font> emptyCharParm , results <font color='#0000FF'> OUT </font> disasterArray ) <font color='#0000FF'> AS </font><br>
<nobr> <font color='#0000FF'> BEGIN </font><br>
<nobr> <font color='#0000FF'> IF </font> localetype <font color='#0000FF'> IS </font><br>
<nobr>&nbsp&nbsp&nbsp&nbsp <font color='#0000FF'> NULL </font><br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> AND </font> localevalues.COUNT = <font color='#FF00FF'> 0 </font> <font color='#0000FF'> THEN </font><br>
<nobr> <font color='#0000FF'> SELECT </font> <font color='#0000FF'> UNIQUE </font> DSTER_ID <font color='#0000FF'> AS </font><br>
<nobr> disaster BULK COLLECT <font color='#0000FF'> INTO </font> results<br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> FROM </font> FEMA_HOUSEHOLD_DATA_HOUSEHOLD fad<br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> WHERE </font> fad.DMGE_STATE_CD = stateid<br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> ORDER </font> <font color='#0000FF'> BY </font> <font color='#FF00FF'> 1 </font> ;<br>
<nobr> <font color='#0000FF'> ELSIF </font> localetype = <font color='#FF00FF'> 'city' </font><br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> AND </font> localevalues.COUNT > <font color='#FF00FF'> 0 </font> <font color='#0000FF'> THEN </font><br>
<nobr> <font color='#0000FF'> SELECT </font> <font color='#0000FF'> UNIQUE </font> DSTER_ID <font color='#0000FF'> AS </font><br>
<nobr> disaster BULK COLLECT <font color='#0000FF'> INTO </font> results<br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> FROM </font> FEMA_HOUSEHOLD_DATA_HOUSEHOLD fad<br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> WHERE </font> fad.DMGE_STATE_CD = stateid<br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> AND </font> fad.DMGE_CITY_NAME <font color='#0000FF'> IN </font> (<br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> SELECT </font> *<br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> FROM </font> <font color='#0000FF'> TABLE </font> ( localevalues ) )<br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> ORDER </font> <font color='#0000FF'> BY </font> <font color='#FF00FF'> 1 </font> ;<br>
<nobr> <font color='#0000FF'> ELSIF </font> localetype = <font color='#FF00FF'> 'county' </font><br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> AND </font> localevalues.COUNT > <font color='#FF00FF'> 0 </font> <font color='#0000FF'> THEN </font><br>
<nobr> <font color='#0000FF'> SELECT </font> <font color='#0000FF'> UNIQUE </font> DSTER_ID <font color='#0000FF'> AS </font><br>
<nobr> disaster BULK COLLECT <font color='#0000FF'> INTO </font> results<br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> FROM </font> FEMA_HOUSEHOLD_DATA_HOUSEHOLD fad<br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> WHERE </font> fad.DMGE_STATE_CD = stateid<br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> AND </font> fad.CNTY_NAME <font color='#0000FF'> IN </font> (<br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> SELECT </font> *<br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> FROM </font> <font color='#0000FF'> TABLE </font> ( localevalues ) )<br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> ORDER </font> <font color='#0000FF'> BY </font> <font color='#FF00FF'> 1 </font> ;<br>
<nobr> <font color='#0000FF'> ELSIF </font> localetype = <font color='#FF00FF'> 'congrdist' </font><br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> AND </font> localevalues.COUNT > <font color='#FF00FF'> 0 </font> <font color='#0000FF'> THEN </font><br>
<nobr> <font color='#0000FF'> SELECT </font> <font color='#0000FF'> UNIQUE </font> DSTER_ID <font color='#0000FF'> AS </font><br>
<nobr> disaster BULK COLLECT <font color='#0000FF'> INTO </font> results<br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> FROM </font> FEMA_HOUSEHOLD_DATA_HOUSEHOLD fad<br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> WHERE </font> fad.DMGE_STATE_CD = stateid<br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> AND </font> fad.FCD_FIPS91_CD <font color='#0000FF'> IN </font> (<br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> SELECT </font> *<br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> FROM </font> <font color='#0000FF'> TABLE </font> ( localevalues ) )<br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> ORDER </font> <font color='#0000FF'> BY </font> <font color='#FF00FF'> 1 </font> ;<br>
<nobr> <font color='#0000FF'> END </font> <font color='#0000FF'> IF </font> ;<br>
<nobr> <font color='#0000FF'> EXCEPTION </font><br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> WHEN </font> no_data_found <font color='#0000FF'> THEN </font><br>
<nobr> DBMS_OUTPUT.PUT_LINE ( <font color='#FF00FF'> 'No data returned' </font> ) ;<br>
<nobr> <font color='#0000FF'> RAISE </font> ;<br>
<nobr> <font color='#0000FF'> END </font> get_disasters ;<br>
<nobr> <font color='#0000FF'> PROCEDURE </font> get_records ( disasterid <font color='#0000FF'> IN </font> nbrParameterArray <font color='#0000FF'> DEFAULT </font> emptyNbrParm , stateid <font color='#0000FF'> IN </font> <font color='#0000FF'> VARCHAR2 </font> <font color='#0000FF'> DEFAULT </font> <font color='#0000FF'> NULL </font> , localetype <font color='#0000FF'> IN </font> <font color='#0000FF'> VARCHAR2 </font> <font color='#0000FF'> DEFAULT </font> <font color='#0000FF'> NULL </font> , localevalues <font color='#0000FF'> IN </font> charParameterArray <font color='#0000FF'> DEFAULT </font> emptyCharParm , results <font color='#0000FF'> OUT </font> recordArray ) <font color='#0000FF'> AS </font><br>
<nobr> localeParmCount <font color='#0000FF'> NUMBER </font> ( <font color='#FF00FF'> 5 </font> ) : = localevalues.COUNT ;<br>
<nobr> disasterParmCount <font color='#0000FF'> NUMBER </font> ( <font color='#FF00FF'> 5 </font> ) : = disasterid.COUNT ;<br>
<nobr> <font color='#0000FF'> BEGIN </font><br>
<nobr> <font color='#0000FF'> SELECT </font> * BULK COLLECT <font color='#0000FF'> INTO </font> results<br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> FROM </font> FEMA_HOUSEHOLD_DATA_HOUSEHOLD fad<br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> WHERE </font> ( disasterParmCount = <font color='#FF00FF'> 0 </font><br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> OR </font> fad.DSTER_ID <font color='#0000FF'> IN </font> (<br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> SELECT </font> *<br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> FROM </font> <font color='#0000FF'> TABLE </font> ( disasterid ) ) )<br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> AND </font> ( stateid <font color='#0000FF'> IS </font> <font color='#0000FF'> NULL </font><br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> OR </font> fad.DMGE_STATE_CD = stateid )<br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> AND </font> ( ( localetype <font color='#0000FF'> IS </font> <font color='#0000FF'> NULL </font><br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> AND </font> localeParmCount = <font color='#FF00FF'> 0 </font> )<br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> OR </font> ( localetype = <font color='#FF00FF'> 'city' </font><br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> AND </font> fad.DMGE_CITY_NAME <font color='#0000FF'> IN </font> (<br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> SELECT </font> *<br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> FROM </font> <font color='#0000FF'> TABLE </font> ( localevalues ) ) )<br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> OR </font> ( localetype = <font color='#FF00FF'> 'county' </font><br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> AND </font> fad.CNTY_NAME <font color='#0000FF'> IN </font> (<br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> SELECT </font> *<br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> FROM </font> <font color='#0000FF'> TABLE </font> ( localevalues ) ) )<br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> OR </font> ( localetype = <font color='#FF00FF'> 'congrdist' </font><br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> AND </font> fad.FCD_FIPS91_CD <font color='#0000FF'> IN </font> (<br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> SELECT </font> *<br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> FROM </font> <font color='#0000FF'> TABLE </font> ( localevalues ) ) ) ) ;<br>
<nobr> <font color='#0000FF'> EXCEPTION </font><br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> WHEN </font> no_data_found <font color='#0000FF'> THEN </font><br>
<nobr> DBMS_OUTPUT.PUT_LINE ( <font color='#FF00FF'> 'No data returned' </font> ) ;<br>
<nobr> <font color='#0000FF'> RAISE </font> ;<br>
<nobr> <font color='#0000FF'> END </font> get_records ;<br>
<nobr> <font color='#0000FF'> PROCEDURE </font> get_summary_records ( disasterid <font color='#0000FF'> IN </font> nbrParameterArray <font color='#0000FF'> DEFAULT </font> emptyNbrParm , stateid <font color='#0000FF'> IN </font> <font color='#0000FF'> VARCHAR2 </font> <font color='#0000FF'> DEFAULT </font> <font color='#0000FF'> NULL </font> , localetype <font color='#0000FF'> IN </font> <font color='#0000FF'> VARCHAR2 </font> <font color='#0000FF'> DEFAULT </font> <font color='#0000FF'> NULL </font> , localevalues <font color='#0000FF'> IN </font> charParameterArray <font color='#0000FF'> DEFAULT </font> emptyCharParm , results <font color='#0000FF'> OUT </font> summaryArray ) <font color='#0000FF'> AS </font><br>
<nobr> localeParmCount <font color='#0000FF'> NUMBER </font> ( <font color='#FF00FF'> 5 </font> ) : = localevalues.COUNT ;<br>
<nobr> disasterParmCount <font color='#0000FF'> NUMBER </font> ( <font color='#FF00FF'> 5 </font> ) : = disasterid.COUNT ;<br>
<nobr> <font color='#0000FF'> BEGIN </font><br>
<nobr> <font color='#0000FF'> SELECT </font> <font color='#0000FF'> SUM </font> ( HSHD_SIZE_CNT ) <font color='#0000FF'> AS </font><br>
<nobr> HSHD_SIZE_CNT , <font color='#0000FF'> SUM </font> ( DPNDNT_CNT ) <font color='#0000FF'> AS </font><br>
<nobr> DPNDNT_CNT , <font color='#0000FF'> SUM </font> ( INCM_AMNT ) <font color='#0000FF'> AS </font><br>
<nobr> INCM_AMNT , <font color='#0000FF'> SUM </font> ( HZRD_INSNC_AMNT ) <font color='#0000FF'> AS </font><br>
<nobr> HZRD_INSNC_AMNT , <font color='#0000FF'> SUM </font> ( FLOOD_INSNC_AMNT ) <font color='#0000FF'> AS </font><br>
<nobr> FLOOD_INSNC_AMNT , <font color='#0000FF'> SUM </font> ( OTHER_INSNC_AMNT ) <font color='#0000FF'> AS </font><br>
<nobr> OTHER_INSNC_AMNT , <font color='#0000FF'> SUM </font> ( REAL_PROP_LOSS_AMNT ) <font color='#0000FF'> AS </font><br>
<nobr> REAL_PROP_LOSS_AMNT , <font color='#0000FF'> SUM </font> ( FLOOD_DMGE_AMNT ) <font color='#0000FF'> AS </font><br>
<nobr> FLOOD_DMGE_AMNT , <font color='#0000FF'> SUM </font> ( FNDTN_DMGE_AMNT ) <font color='#0000FF'> AS </font><br>
<nobr> FNDTN_DMGE_AMNT , <font color='#0000FF'> SUM </font> ( ROOF_DMGE_AMNT ) <font color='#0000FF'> AS </font><br>
<nobr> ROOF_DMGE_AMNT , <font color='#0000FF'> SUM </font> ( TMP_SHLTR_RCVD_AMNT ) <font color='#0000FF'> AS </font><br>
<nobr> TMP_SHLTR_RCVD_AMNT , <font color='#0000FF'> SUM </font> ( RENT_ASSTN_AMNT ) <font color='#0000FF'> AS </font><br>
<nobr> RENT_ASSTN_AMNT , <font color='#0000FF'> SUM </font> ( REPR_AMNT ) <font color='#0000FF'> AS </font><br>
<nobr> REPR_AMNT , <font color='#0000FF'> SUM </font> ( RPMT_AMNT ) <font color='#0000FF'> AS </font><br>
<nobr> RPMT_AMNT , <font color='#0000FF'> SUM </font> ( SBA_RCVD_AMNT ) <font color='#0000FF'> AS </font><br>
<nobr> SBA_RCVD_AMNT , <font color='#0000FF'> SUM </font> ( PRSNL_PROP_ASSTN_AMNT ) <font color='#0000FF'> AS </font><br>
<nobr> PRSNL_PROP_ASSTN_AMNT , <font color='#0000FF'> SUM </font> ( OTHER_ASSTN_AMNT ) <font color='#0000FF'> AS </font><br>
<nobr> OTHER_ASSTN_AMNT , <font color='#0000FF'> SUM </font> ( TOTAL_DMGE_AMNT ) <font color='#0000FF'> AS </font><br>
<nobr> TOTAL_DMGE_AMNT , <font color='#0000FF'> SUM </font> ( TOTAL_ASSTN_AMNT ) <font color='#0000FF'> AS </font><br>
<nobr> TOTAL_ASSTN_AMNT , <font color='#0000FF'> SUM </font> ( HUD_UNMT_NEED_AMNT ) <font color='#0000FF'> AS </font><br>
<nobr> HUD_UNMT_NEED_AMNT BULK COLLECT <font color='#0000FF'> INTO </font> results<br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> FROM </font> FEMA_HOUSEHOLD_DATA_HOUSEHOLD fad<br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> WHERE </font> ( disasterParmCount = <font color='#FF00FF'> 0 </font><br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> OR </font> fad.DSTER_ID <font color='#0000FF'> IN </font> (<br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> SELECT </font> *<br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> FROM </font> <font color='#0000FF'> TABLE </font> ( disasterid ) ) )<br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> AND </font> ( stateid <font color='#0000FF'> IS </font> <font color='#0000FF'> NULL </font><br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> OR </font> fad.DMGE_STATE_CD = stateid )<br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> AND </font> ( ( localetype <font color='#0000FF'> IS </font> <font color='#0000FF'> NULL </font><br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> AND </font> localeParmCount = <font color='#FF00FF'> 0 </font> )<br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> OR </font> ( localetype = <font color='#FF00FF'> 'city' </font><br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> AND </font> fad.DMGE_CITY_NAME <font color='#0000FF'> IN </font> (<br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> SELECT </font> *<br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> FROM </font> <font color='#0000FF'> TABLE </font> ( localevalues ) ) )<br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> OR </font> ( localetype = <font color='#FF00FF'> 'county' </font><br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> AND </font> fad.CNTY_NAME <font color='#0000FF'> IN </font> (<br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> SELECT </font> *<br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> FROM </font> <font color='#0000FF'> TABLE </font> ( localevalues ) ) )<br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> OR </font> ( localetype = <font color='#FF00FF'> 'congrdist' </font><br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> AND </font> fad.FCD_FIPS91_CD <font color='#0000FF'> IN </font> (<br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> SELECT </font> *<br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> FROM </font> <font color='#0000FF'> TABLE </font> ( localevalues ) ) ) ) ;<br>
<nobr> <font color='#0000FF'> EXCEPTION </font><br>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000FF'> WHEN </font> no_data_found <font color='#0000FF'> THEN </font><br>
<nobr> DBMS_OUTPUT.PUT_LINE ( <font color='#FF00FF'> 'No data returned' </font> ) ;<br>
<nobr> <font color='#0000FF'> RAISE </font> ;<br>
<nobr> <font color='#0000FF'> END </font> get_summary_records ;<br>
<nobr> <font color='#0000FF'> END </font> fema_data ;<br>
<nobr> /<br>
<ul>
<font color='#FF0000'><li>RC=-1,Error found in QA of script - see above</font><br>
